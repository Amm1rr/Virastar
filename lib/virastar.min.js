/*!
* Virastar - v0.16.0 - 2019-04-12
* https://github.com/brothersincode/virastar
* Licensed: MIT
*/
!function(e,a,r){"undefined"!=typeof module?module.exports=r():"function"==typeof define&&"object"==typeof define.amd?define(r):"undefined"!=typeof window?window[e]=r():a[e]=r()}("Virastar",this,function(){function e(a,r){if(!(this instanceof e))return new e(a,r);if(a=a||{},"object"==typeof a)this.opts=this.parseOptions(a);else if("string"==typeof a)return this.opts=this.parseOptions(r||{}),this.cleanup(a);return this}return e.prototype={defaults:{normalize_eol:!0,decode_htmlentities:!0,fix_dashes:!0,fix_three_dots:!0,fix_english_quotes_pairs:!0,fix_english_quotes:!0,fix_hamzeh:!0,cleanup_rlm:!0,cleanup_zwnj:!0,fix_spacing_for_braces_and_quotes:!0,fix_arabic_numbers:!0,fix_english_numbers:!0,fix_misc_non_persian_chars:!0,fix_punctuations:!0,fix_question_mark:!0,skip_markdown_ordered_lists_numbers_conversion:!0,fix_perfix_spacing:!0,fix_suffix_spacing:!0,aggresive:!0,kashidas_as_parenthetic:!0,cleanup_kashidas:!0,cleanup_extra_marks:!0,cleanup_spacing:!0,cleanup_begin_and_end:!0,preserve_HTML:!0,preserve_URIs:!0,preserve_brackets:!0,preserve_braces:!0},numbersPersian:"۱۲۳۴۵۶۷۸۹۰",numbersArabic:"١٢٣٤٥٦٧٨٩٠",numbersEnglish:"1234567890",parseOptions:function(e){var a=this.defaults;for(var r in a)e.hasOwnProperty(r)&&(a[r]=e[r]);return a},charBatchReplace:function(e,a,r){var s=a.split(""),n=r.split("");for(var _ in s)e=e.replace(new RegExp(s[_],"g"),n[_]);return e},cleanup:function(e,a){var r=this,s=a?r.parseOptions(a):r.opts;if(s.preserve_HTML){var n=[];e=e.replace(/(<[^<>]+>)/g,function(e){return n.push(e),"__HTML__PRESERVER__"})}if(s.preserve_URIs){var _=[],c=new RegExp("([A-Za-z][A-Za-z0-9+\\-.]*):(?:(//)(?:((?:[A-Za-z0-9\\-._~!$&'()*+,;=:]|%[0-9A-Fa-f]{2})*)@)?((?:\\[(?:(?:(?:(?:[0-9A-Fa-f]{1,4}:){6}|::(?:[0-9A-Fa-f]{1,4}:){5}|(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,1}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){3}|(?:(?:[0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){2}|(?:(?:[0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:|(?:(?:[0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})?::)(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))|(?:(?:[0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})?::)|[Vv][0-9A-Fa-f]+\\.[A-Za-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:[A-Za-z0-9\\-._~!$&'()*+,;=]|%[0-9A-Fa-f]{2})*))(?::([0-9]*))?((?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|/((?:(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)?)|((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|)(?:\\?((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?(?:\\#((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?","g");e=e.replace(c,function(e){return _.push(e),"__URI__PRESERVER__"})}if(s.preserve_brackets){var p=[];e=e.replace(/(\[.*?\])/g,function(e){return p.push(e),"__BRACKETS__PRESERVER__"})}if(s.preserve_braces){var i=[];e=e.replace(/(\{.*?\})/g,function(e){return i.push(e),"__BRACES__PRESERVER__"})}return s.normalize_eol&&(e=e.replace(/(\r?\n)|(\r\n?)/g,"\n")),s.decode_htmlentities&&(e=e.replace(/&#(\d+);/g,function(e,a){return String.fromCharCode(a)})),s.fix_dashes&&(e=e.replace(/-{3}/g,"—"),e=e.replace(/-{2}/g,"–")),s.fix_three_dots&&(e=e.replace(/\s*\.{3,}/g,"…")),s.fix_english_quotes_pairs&&(e=e.replace(/(“)(.+?)(”)/g,"«$2»")),s.fix_english_quotes&&(e=e.replace(/&quot;/g,'"'),e=e.replace(/&apos;/g,"'"),e=e.replace(/(["'`]+)(.+?)(\1)/g,"«$2»")),s.fix_hamzeh&&(e=e.replace(/(\S)(ه[\s\u200C]+[یي])(\s)/g,"$1هٔ$3")),s.cleanup_rlm&&(e=e.replace(/([^a-zA-Z\-_])(\u200F)/g,"$1‌")),s.cleanup_zwnj&&(e=r.cleanupZWNJ(e)),s.fix_arabic_numbers&&(e=r.charBatchReplace(e,r.numbersArabic,r.numbersPersian)),e=e.replace(/(^|\s+)([[({"'“«]?)(\S+)([\])}"'”»]?)(?=($|\s+))/g,function(e,a,n,_,c,p){return _.match(/[a-zA-Z\-_]{2,}/g)?e:_.match(/%(?:\d+\$)?[+-]?(?:[ 0]|'.{1})?-?\d*(?:\.\d+)?[bcdeEufFgGosxX]/g)?e:_.match(/&#\d+;/g)?e:s.skip_markdown_ordered_lists_numbers_conversion&&(e+c+p).match(/(?:(?:\r?\n)|(?:\r\n?)|(?:^|\n))\d+\.\s/)?e:(s.fix_english_numbers&&(e=r.charBatchReplace(e,r.numbersEnglish,r.numbersPersian)),s.fix_punctuations&&(e=r.charBatchReplace(e,"%,;","٪،؛")),s.fix_misc_non_persian_chars&&(e=e.replace(/ك/g,"ک").replace(/ي/g,"ی").replace(/ى/g,"ی").replace(/ۍ/g,"ی").replace(/ې/g,"ی").replace(/ہ/g,"ه").replace(/[ەھ]/g,"ه")),s.fix_question_mark&&(e=e.replace(/(\?)/g,"؟")),e)}),s.fix_perfix_spacing&&(e=e.replace(/((\s|^)ن?می)\u0020/g,"$1‌"),e=e.replace(/((\s|^)بی)\u0020/g,"$1‌")),s.fix_suffix_spacing&&(e=e.replace(/\u0020(ام|ات|اش|ای|اید|ایم|اند)\s/g,"‌$1"),e=e.replace(/\u0020(ها(ی)?\s)/g,"‌$1"),e=e.replace(/\u0020(تر((ی)|(ین))?\s)/g,"‌$1"),e=e.replace(/\u0020(هایی|هایم|هایت|هایش|هایمان|هایتان|هایشان)\s/g,"‌$1")),s.aggresive&&(s.cleanup_extra_marks&&(e=e.replace(/(!){2,}/g,"$1"),e=e.replace(/(\u061F){2,}/g,"$1")),s.kashidas_as_parenthetic&&(e=e.replace(/(\s)\u0640+/g,"$1–"),e=e.replace(/\u0640+(\s)/g,"–$1")),s.cleanup_kashidas&&(e=e.replace(/(\S)\u0640+(\S)/g,"$1$2"))),s.fix_spacing_for_braces_and_quotes&&(e=e.replace(/[ \t\u200C]*(\()\s*([^)]+?)\s*?(\))[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*(\[)\s*([^\]]+?)\s*?(\])[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*(\{)\s*([^}]+?)\s*?(\})[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*(“)\s*([^”]+?)\s*?(”)[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*(«)\s*([^»]+?)\s*?(»)[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*([:;,؛،.؟!]{1})[ \t\u200C]*/g,"$1 "),e=e.replace(/([0-9۰-۹]+):\s+([0-9۰-۹]+)/g,"$1:$2"),e=e.replace(/([0-9۰-۹]+). ([0-9۰-۹]+)/g,"$1.$2"),e=e.replace(/(\u061F|!)\s(\u061F|!)/g,"$1$2"),e=e.replace(/(\()\s*([^)]+?)\s*?(\))/g,"$1$2$3"),e=e.replace(/(\[)\s*([^\]]+?)\s*?(\])/g,"$1$2$3"),e=e.replace(/(\{)\s*([^}]+?)\s*?(\})/g,"$1$2$3"),e=e.replace(/(“)\s*([^”]+?)\s*?(”)/g,"$1$2$3"),e=e.replace(/(«)\s*([^»]+?)\s*?(»)/g,"$1$2$3")),s.cleanup_spacing&&(e=e.replace(/[ ]+/g," "),e=e.replace(/([\n]+)[ \t\u200C]*/g,"$1")),s.cleanup_begin_and_end&&(e=e.replace(/^[\s\u200c]+|[\s\u200c]+$/g,"")),s.preserve_braces&&(e=e.replace(/__BRACES__PRESERVER__/g,function(){return i.shift()})),s.preserve_brackets&&(e=e.replace(/__BRACKETS__PRESERVER__/g,function(){return p.shift()})),s.preserve_URIs&&(e=e.replace(/__URI__PRESERVER__/g,function(){return _.shift()})),s.preserve_HTML&&(e=e.replace(/__HTML__PRESERVER__/g,function(){return n.shift()})),e},cleanupZWNJ:function(e){return e=e.replace(/\u200C{2,}/g,"‌"),e=e.replace(/([۰-۹0-9إأةؤورزژاآدذ،؛,:«»\\\/@#$٪×*()ـ\-=|])\u200c/g,"$1"),e=e.replace(/\u200c([\w])/g,"$1"),e=e.replace(/([\w])\u200c/g,"$1"),e=e.replace(/\u200c([\n\s[].،«»:()؛؟?;$!@-=+\\])/g,"$1"),e=e.replace(/([\n\s[.،«»:()؛؟?;$!@\-=+\\])\u200c/g,"$1"),e=e.replace(/\s+\u200C|\u200C\s+/g," ")},swapQuotes:function(e,a){return e=e.replace(/(»)(.+?)(«)/g,"«$2»"),e=e.replace(/(”)(.+?)(“)/g,"“$2”")}},e});
