!function(e,r,n){"undefined"!=typeof module?module.exports=n():"function"==typeof define&&"object"==typeof define.amd?define(n):"undefined"!=typeof window?window[e]=n():r[e]=n()}("Virastar",this,function(){function e(n,a){if(!(this instanceof e))return new e(n,a);if(n=n||{},"object"==typeof n)this.opts=r(n);else if("string"==typeof n)return this.opts=r(a||{}),t(n);return this}function r(e){var r=Object.assign({},W);for(var n in r)e.hasOwnProperty(n)&&(r[n]=e[n]);return r}function n(e,r,n){var a=r.split(""),t=n.split("");for(var _ in a)e=e.replace(c(a[_]),t[_]);return e}function a(e,r){for(var n in r)r.hasOwnProperty(n)&&(e=e.replace(c("["+r[n]+"]"),n));return e}function c(e,r){return new RegExp(e,r||"g")}function t(e,n){if("string"!=typeof e)throw new TypeError("Expected a String, but received "+typeof e);if(!e.trim())return e;var a=n?r(n):this.opts;if(e=" "+e+" ",a.preserve_frontmatter){var t=[];e=e.replace(/^ ---[\S\s]*---\s*/g,function(e){return t.push(e)," __FRONTMATTER__PRESERVER__ "})}if(a.preserve_HTML){var A=[];e=e.replace(/<\/?[a-z][^>]*?>/gi,function(e){return A.push(e)," __HTML__PRESERVER__ "})}if(a.preserve_comments){var U=[];e=e.replace(/<!--[\s\S]*?-->/g,function(e){return U.push(e)," __COMMENT__PRESERVER__ "})}if(a.preserve_brackets){var B=[];e=e.replace(/(\[.*?\])/g,function(e){return B.push(e)," __BRACKETS__PRESERVER__ "})}if(a.preserve_braces){var H=[];e=e.replace(/(\{.*?\})/g,function(e){return H.push(e)," __BRACES__PRESERVER__ "})}if(a.preserve_URIs){var K=[],Q=[];e=e.replace(/(!)?\[(.*[^\]])?\]\((.*[^)])\)/g,function(e,r,n,a){return n&&(n=n.replace(/!\[(.*?)\]\((.*?[^)])\)/g,function(e,r,n){return K.push(n.trim()),"!["+(r||"")+"](__MD_LINK__PRESERVER__)"})),K.push(a.trim()),(r||"")+"["+(n||"")+"](__MD_LINK__PRESERVER__)"}),e=e.replace(c(D),function(e){return Q.push(e)," __URI__PRESERVER__ "})}if(a.preserve_nbsps){var W=[];e=e.replace(/&nbsp;|&#160;/gi,function(e){return W.push(e)," __NBSPS__PRESERVER__ "})}if(a.decode_htmlentities&&(e=s(e,a)),a.preserve_entities){var X=[];e=e.replace(/&(#?[^;\W]+;?)/g,function(e){return X.push(e)," __ENTITIES__PRESERVER__ "})}return a.normalize_eol&&(e=i(e,a)),a.fix_persian_glyphs&&(e=m(e,a)),a.fix_dashes&&(e=p(e,a)),a.fix_three_dots&&(e=f(e,a)),a.normalize_ellipsis&&(e=o(e,a)),a.fix_english_quotes_pairs&&(e=l(e,a)),a.fix_english_quotes&&(e=g(e,a)),a.fix_hamzeh?(a.fix_hamzeh_arabic&&(e=h(e,a)),e=$(e,a)):a.fix_suffix_spacing&&(a.fix_hamzeh_arabic&&(e=E(e,a)),e=P(e,a)),a.cleanup_rlm&&(e=R(e,a)),a.cleanup_zwnj&&(e=_(e,a)),a.fix_arabic_numbers&&(e=x(e,a)),e=e.replace(/(^|\s+)([[({"'“«]?)(\S+)([\])}"'”»]?)(?=($|\s+))/g,function(e,r,n,c,t,_){return c.match(/[a-zA-Z\-_]{2,}/g)?e:c.match(/%(?:\d+\$)?[+-]?(?:[ 0]|'.{1})?-?\d*(?:\.\d+)?[bcdeEufFgGosxX]/g)?e:c.match(/&#\d+;/g)?e:a.skip_markdown_ordered_lists_numbers_conversion&&(e+t+_).match(/(?:(?:\r?\n)|(?:\r\n?)|(?:^|\n))\d+\.\s/)?e:(a.fix_english_numbers&&(e=v(e,a)),a.fix_numeral_symbols&&(e=S(e,a)),a.fix_punctuations&&(e=F(e,a)),a.fix_misc_non_persian_chars&&(e=d(e,a)),a.fix_question_mark&&(e=b(e,a)),e)}),a.fix_perfix_spacing&&(e=z(e,a)),a.fix_suffix_spacing&&(e=w(e,a)),a.fix_suffix_misc&&(e=T(e,a)),a.fix_spacing_for_braces_and_quotes&&(e=Z(e,a)),a.cleanup_extra_marks&&(e=k(e,a)),a.fix_spacing_for_punctuations&&(e=y(e,a)),a.kashidas_as_parenthetic&&(e=V(e,a)),a.cleanup_kashidas&&(e=q(e,a)),a.markdown_normalize_braces&&(e=M(e,a)),a.markdown_normalize_lists&&(e=C(e,a)),a.fix_spacing_for_braces_and_quotes&&(e=I(e,a)),a.fix_diacritics&&(e=N(e,a)),a.cleanup_spacing&&(e=O(e,a)),a.cleanup_zwnj&&(e=u(e,a)),a.cleanup_line_breaks&&(e=j(e,a)),a.preserve_entities&&(e=e.replace(/[ ]?__ENTITIES__PRESERVER__[ ]?/g,function(){return X.shift()})),a.preserve_nbsps&&(e=e.replace(/[ ]?__NBSPS__PRESERVER__[ ]?/g,function(){return W.shift()})),a.preserve_URIs&&(e=e.replace(/__MD_LINK__PRESERVER__/g,function(){return K.shift()}),e=e.replace(/[ ]?__URI__PRESERVER__[ ]?/g,function(){return Q.shift()})),a.preserve_braces&&(e=e.replace(/[ ]?__BRACES__PRESERVER__[ ]?/g,function(){return H.shift()})),a.preserve_brackets&&(e=e.replace(/[ ]?__BRACKETS__PRESERVER__[ ]?/g,function(){return B.shift()})),a.preserve_comments&&(e=e.replace(/[ ]?__COMMENT__PRESERVER__[ ]?/g,function(){return U.shift()})),a.preserve_HTML&&(e=e.replace(/[ ]?__HTML__PRESERVER__[ ]?/g,function(){return A.shift()})),a.preserve_frontmatter&&(e=e.replace(/[ ]?__FRONTMATTER__PRESERVER__[ ]?/g,function(){return t.shift()})),e=a.cleanup_begin_and_end?L(e,a):e.replace(/^[ ]/g,"").replace(/[ ]$/g,"")}function _(e,r){return e.replace(/\u00ad/g,"‌").replace(/\u200c{2,}/g,"‌").replace(/\u200c([\w\s0-9۰-۹[\](){}«»“”.…,:;?!$%@#*=+\-\/\\،؛٫٬×٪؟ـ])/g,"$1").replace(/([\w\s0-9۰-۹[\](){}«»“”.…,:;?!$%@#*=+\-\/\\،؛٫٬×٪؟ـ])\u200c/g,"$1").replace(/(^\u200c|\u200c$)/gm,"")}function u(e,r){return e.replace(/([إأةؤورزژاآدذ،؛,:«»\\\/@#$٪×*()ـ\-=|])\u200c/g,"$1")}function s(e,r){return e.replace(/&(#?[^;\W]+;?)/g,function(e,r){var n;if(n=/^#(\d+);?$/.exec(r))return String.fromCharCode(parseInt(n[1],10));if(n=/^#[Xx]([A-Fa-f0-9]+);?/.exec(r))return String.fromCharCode(parseInt(n[1],16));var a=/;$/.test(r),c=a?r.replace(/;$/,""):r,t=G[c]||a&&G[r];return"number"==typeof t?String.fromCharCode(t):"string"==typeof t?t:"&"+r})}function i(e,r){return e.replace(/(\r?\n)|(\r\n?)/g,"\n")}function p(e,r){return e.replace(/-{3}/g,"—").replace(/-{2}/g,"–")}function f(e,r){return e.replace(/\s*\.{3,}/g,"…")}function o(e,r){return e.replace(/(…){2,}/g,"…").replace(/([ ]{1,})*…[ \t\u200c]*/g,"$1… ")}function l(e,r){return e.replace(/(“)(.+?)(”)/g,"«$2»")}function g(e,r){return e.replace(/(["'`]+)(.+?)(\1)/g,"«$2»")}function $(e,r){var n="$1هٔ$3";return e.replace(/(\S)(ه[\s\u200c\u200e]+[یي])([\s\u200c\u200e])/g,n).replace(/(\S)(ه[\s\u200c\u200e]?\u0621)([\s\u200c\u200e])/g,n).replace(/(ۀ|هٓ)/g,"هٔ")}function h(e,r){return e.replace(/(\S)ة([\s\u200c\u200e])/g,"$1هٔ$2")}function E(e,r){return e.replace(/(\S)ة([\s\u200c\u200e])/g,"$1ه‌ی$2")}function R(e,r){return e.replace(/([^a-zA-Z\-_])(\u200F)/g,"$1‌")}function m(e,r){return a(e,J)}function d(e,r){return n(e,"كڪيىۍېہە","ککییییههه")}function v(e,r){return n(e,"1234567890",X)}function x(e,r){return n(e,"١٢٣٤٥٦٧٨٩٠",X)}function A(e,r){return e.replace(/[\u0660-\u0669\u06f0-\u06f9]/g,function(e){return 15&e.charCodeAt(0)})}function S(e,r){return e.replace(/([۰-۹]) ?%/g,"$1٪").replace(/([۰-۹])\.(?=[۰-۹])/g,"$1٫").replace(/([۰-۹]),(?=[۰-۹])/g,"$1٬")}function F(e,r){return n(e,",;","،؛")}function b(e,r){return e.replace(/(\?)/g,"؟")}function z(e,r){var n="$1‌$3";return e.replace(/((\s|^)ن?می) ([^ ])/g,n).replace(/((\s|^)بی) ([^ ])/g,n)}function w(e,r){var n="$1‌$2";return e.replace(c("(["+H+K+"]) (ها(ی)?["+Q+"])"),n).replace(c("(["+H+K+"]) ((ام|ات|اش|ای|اید|ایم|اند|مان|تان|شان)["+Q+"])"),n).replace(c("(["+H+K+"]) (تر((ی)|(ین))?["+Q+"])"),n).replace(c("(["+H+K+"]) ((هایی|هایم|هایت|هایش|هایمان|هایتان|هایشان)["+Q+"])"),n)}function P(e,r){var n="$1ه‌ی$3";return e.replace(/(\S)(ه[\s\u200c]+[یي])([\s\u200c])/g,n).replace(/(\S)(ه[\s\u200c]?\u0621)([\s\u200c])/g,n).replace(/(\S)(ه[\s\u200c]?\u0654)([\s\u200c])/g,n)}function T(e,r){return e.replace(/(\S)ه[\u200c\u200e][ئی]ی([\s\u200c\u200e])/g,"$1ه‌ای$2")}function k(e,r){return e.replace(/(!){2,}/g,"$1").replace(/(\u061F|\?){2,}/g,"$1").replace(/(!)([\s]*)([\u061F?])/g,"$3$1")}function V(e,r){return e.replace(/(\s)\u0640+/g,"$1–").replace(/\u0640+(\s)/g,"–$1")}function q(e,r){return e.replace(/([0-9۰-۹]+)ـ+([0-9۰-۹]+)/g,"$1–$2").replace(/(\S)\u0640+(\S)/g,"$1$2").replace(/(\S)\u0640+(\S)/g,"$1$2")}function y(e,r){return e.replace(/[ \t\u200c]*([:;,؛،.؟?!]{1})[ \t\u200c]*/g,"$1 ").replace(/([0-9۰-۹]+):\s+([0-9۰-۹]+)/g,"$1:$2").replace(/([0-9۰-۹]+)\. ([0-9۰-۹]+)/g,"$1.$2").replace(/([\w\-_]+)\. (ir|com|org|net|info|edu|me)([\s\/\\\])»:;.])/g,"$1.$2$3").replace(/([\u061F?!])\s+([\u061F?!])/g,"$1$2").replace(/!\s{1,}!/g,"!!").replace(/\?\s{1,}\?/g,"??").replace(/؟\s{1,}؟/g,"؟؟")}function Z(e,r){var n=" $1$2$3 ";return e.replace(/[ \t\u200c]*(\()\s*([^)]+?)\s*?(\))[ \t\u200c]*/g,n).replace(/[ \t\u200c]*(\[)\s*([^\]]+?)\s*?(\])[ \t\u200c]*/g,n).replace(/[ \t\u200c]*(\{)\s*([^}]+?)\s*?(\})[ \t\u200c]*/g,n).replace(/[ \t\u200c]*(“)\s*([^”]+?)\s*?(”)[ \t\u200c]*/g,n).replace(/[ \t\u200c]*(«)\s*([^»]+?)\s*?(»)[ \t\u200c]*/g,n)}function I(e,r){var n="$1$2$3";return e.replace(/(\()\s*([^)]+?)\s*?(\))/g,n).replace(/(\[)\s*([^\]]+?)\s*?(\])/g,n).replace(/(\{)\s*([^}]+?)\s*?(\})/g,n).replace(/(“)\s*([^”]+?)\s*?(”)/g,n).replace(/(«)\s*([^»]+?)\s*?(»)/g,n)}function M(e,r){return e.replace(/! (\[.*?\])\s?(\(.*?\))[ ]?/g,"!$1$2").replace(/(\[.*?\])\s+(\(.*?\))/g,"$1$2").replace(/\(\(\s*(.*?)\s*\)\)/g,"(($1))").replace(/\[\[\s*(.*?)\s*\]\]/g,"[[$1]]").replace(/\{\{\s*(.*?)\s*\}\}/g,"{{$1}}").replace(/\{\{\{\s*(.*?)\s*\}\}\}/g,"{{{$1}}}").replace(/(\(\(.*\))\s+(\))/g,"$1$2").replace(/(\[\[.*\])\s+(\])/g,"$1$2").replace(/(\{\{.*\})\s+(\})/g,"$1$2")}function C(e,r){return e.replace(/((\n|^)\*.*?)\n+(?=\n\*)/g,"$1").replace(/((\n|^)-.*?)\n+(?=\n-)/g,"$1").replace(/((\n|^)#.*?)\n+(?=\n#)/g,"$1")}function N(e,r){return e.replace(c("‌(["+K+"])"),"$1").replace(c("(.*)(["+K+"]){2,}(.*)"),"$1$2$3").replace(c("(\\S)[ ]+(["+K+"])"),"$1$2")}function O(e,r){return e.replace(/[ ]+/g," ").replace(/\n[\s\u200c]*\n/g,"\n\n")}function j(e,r){return e.replace(/(\n{2,})/g,"\n\n")}function L(e,r){return e.replace(/([\n]+)[ \t\u200c\u00a0]*/g,"$1").replace(/^[\s\u200c\u200e\u200f]+|[\s\u200c\u200e\u200f]+$/g,"")}function U(e,r){var n=["-"],a=["!",".","،","…",'"'],t=[],_=[];e=f(e,r);for(var u=0;u<a.length;u++){var s=a[u],i=c("^\\"+s,"i");i.test(e)&&(e=e.replace(i,"").trim(),_.push(s))}for(var p=0;p<n.length;p++){var l=n[p],g=c("\\"+l+"$","i");g.test(e)&&(e=e.replace(g,"").trim(),t.push(l))}for(var $=0;$<t.length;$++)e=t[$]+" "+e;for(var h=0;h<_.length;h++)e+=_[h];return o(e,r)}function B(e,r){return e.replace(/(»)(.+?)(«)/g,"«$2»").replace(/(”)(.+?)(“)/g,"“$2”")}var H="ءاآأإئؤبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهیةيك",K="ًٌٍَُِّْ",D="([A-Za-z][A-Za-z0-9+\\-.]*):(?:(//)(?:((?:[A-Za-z0-9\\-._~!$&'()*+,;=:]|%[0-9A-Fa-f]{2})*)@)?((?:\\[(?:(?:(?:(?:[0-9A-Fa-f]{1,4}:){6}|::(?:[0-9A-Fa-f]{1,4}:){5}|(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,1}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){3}|(?:(?:[0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){2}|(?:(?:[0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:|(?:(?:[0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})?::)(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))|(?:(?:[0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})?::)|[Vv][0-9A-Fa-f]+\\.[A-Za-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:[A-Za-z0-9\\-._~!$&'()*+,;=]|%[0-9A-Fa-f]{2})*))(?::([0-9]*))?((?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|/((?:(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)?)|((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|)(?:\\?((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?(?:\\#((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?",Q="\\s.,;،؛!؟?\"'()[\\]{}“”«»",W={cleanup_begin_and_end:!0,cleanup_extra_marks:!0,cleanup_kashidas:!0,cleanup_line_breaks:!0,cleanup_rlm:!0,cleanup_spacing:!0,cleanup_zwnj:!0,decode_htmlentities:!0,fix_arabic_numbers:!0,fix_dashes:!0,fix_diacritics:!0,fix_english_numbers:!0,fix_english_quotes_pairs:!0,fix_english_quotes:!0,fix_hamzeh:!0,fix_hamzeh_arabic:!1,fix_misc_non_persian_chars:!0,fix_numeral_symbols:!0,fix_perfix_spacing:!0,fix_persian_glyphs:!0,fix_punctuations:!0,fix_question_mark:!0,fix_spacing_for_braces_and_quotes:!0,fix_spacing_for_punctuations:!0,fix_suffix_misc:!0,fix_suffix_spacing:!0,fix_three_dots:!0,kashidas_as_parenthetic:!0,markdown_normalize_braces:!0,markdown_normalize_lists:!0,normalize_ellipsis:!0,normalize_eol:!0,preserve_braces:!1,preserve_brackets:!1,preserve_comments:!0,preserve_entities:!0,preserve_frontmatter:!0,preserve_HTML:!0,preserve_nbsps:!0,preserve_URIs:!0,skip_markdown_ordered_lists_numbers_conversion:!1},X="۱۲۳۴۵۶۷۸۹۰",G={"sbquo;":"‚","lsquo;":"‘","lsquor;":"‚","ldquo;":"“","ldquor;":"„","rdquo;":"”","rdquor;":"”","rsquo;":"’","rsquor;":"’","apos;":"'","QUOT;":'"',QUOT:'"',"quot;":'"',quot:'"',"zwj;":"‍","ZWNJ;":"‌","zwnj;":"‌","shy;":"­"},J={"‌ه":"ﻫ","ی‌":"ﻰﻲ","ﺃ":"ﺄﺃ","ﺁ":"ﺁﺂ","ﺇ":"ﺇﺈ","ا":"ﺎا","ب":"ﺏﺐﺑﺒ","پ":"ﭖﭗﭘﭙ","ت":"ﺕﺖﺗﺘ","ث":"ﺙﺚﺛﺜ","ج":"ﺝﺞﺟﺠ","چ":"ﭺﭻﭼﭽ","ح":"ﺡﺢﺣﺤ","خ":"ﺥﺦﺧﺨ","د":"ﺩﺪ","ذ":"ﺫﺬ","ر":"ﺭﺮ","ز":"ﺯﺰ","ژ":"ﮊﮋ","س":"ﺱﺲﺳﺴ","ش":"ﺵﺶﺷﺸ","ص":"ﺹﺺﺻﺼ","ض":"ﺽﺾﺿﻀ","ط":"ﻁﻂﻃﻄ","ظ":"ﻅﻆﻇﻈ","ع":"ﻉﻊﻋﻌ","غ":"ﻍﻎﻏﻐ","ف":"ﻑﻒﻓﻔ","ق":"ﻕﻖﻗﻘ","ک":"ﮎﮏﮐﮑﻙﻚﻛﻜ","گ":"ﮒﮓﮔﮕ","ل":"ﻝﻞﻟﻠ","م":"ﻡﻢﻣﻤ","ن":"ﻥﻦﻧﻨ","ه":"ﻩﻪﻫﻬ","هٔ":"ﮤﮥ","و":"ﻭﻮ","ﺅ":"ﺅﺆ","ی":"ﯼﯽﯾﯿﻯﻰﻱﻲﻳﻴ","ئ":"ﺉﺊﺋﺌ","لا":"ﻼ","ﻹ":"ﻺ","ﻷ":"ﻸ","ﻵ":"ﻶ"};return e.prototype={defaults:W,cleanup:t,convertPersianNumbers:A,flipPunctuations:U,swapQuotes:B},e});
